{% extends "base.html"%}
{% block page_content %}
{% load static %}
<div class="container">
   <div class="row m-auto col-12 p-0">
      {% if search_term %}
      <h2 class="display-4 col-12 text-center">Search for: {{search_term}}</h2>
      {% else %}
      <h2 class="display-4 col-12 text-center">{{title}}</h2>
      {% include 'breadcrumb.html'%}
      {% endif %}
      <hr class="w-100">
      <div class="col-12">
         <p class="float-left"><a href="{% url 'all_cakes'%}">All Cakes</a> | {{products|length}} out of {{count_all_products}}</p>
         <div class="form-group float-right">
            <form class="" action="{% url 'all_cakes'%}" method="GET">
               <select class="form-control" name="order_by" onchange="this.form.submit()">
                  <option value="0">Default sorting</option>
                  <option value="title">Sort by: name</option>
                  <option value="rating">Sort by: rating</option>
                  <option value="latest">Sort by: latest</option>
                  <option value="low-to-high">Sort by: low to high</option>
                  <option value="high-to-low">Sort by: high to low</option>
               </select>
            </form>
         </div>
      </div>
      <div class="row col-12 mb-2 pt-4">
         {% if products%}
         {% for product in products%}
         <div class="card col-sm-4 mb-1">
            <img src="/media/{{ product.productimage_set.all.first.image }}" class="card-img-top" alt="...">
            <div class="card-body">
               <h5 class="card-title">{{ product.title|capfirst }}</h5>
               {% for item in product.variation_set.all %}
               <p>{{item.title|capfirst}}</p>
               {% endfor %}
               <p>
                  {% for count in star_loop%}
                  {% if count <= product.rating %}
                  <i class="fa fa-star text-warning" aria-hidden="true"></i>
                  {% else %}
                  <i class="fa fa-star-o text-warning" aria-hidden="true"></i>
                  {% endif %}
                  {% endfor %}
               </p>
               <p><strong>{{ product.get_price_range }}</strong></p>
               {% for item in product.variation_set.all %}
               <p>{{item.title|capfirst}}</p>
               {% endfor %}
               <a href="{{ product.get_absolute_url}}" class="btn btn-primary">Select Options</a>
            </div>
         </div>
         {% endfor %}
         {% else %}
         <p>No cakes found !</p>
         {% endif %}
         {% include 'pagination.html'%}
      </div>
   </div>
</div>
{% endblock %}
